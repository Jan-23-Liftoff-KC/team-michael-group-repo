<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Tree Layout 2</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      rect
      {
        fill: white;
        stroke: brown;
        width: 80px;
        height:40px;
        stroke-width: 2;
      }
      path
      {
        fill: none;
        stroke: brown;
        stroke-width: 2;
      }
      text
      {
        fill: green;
        dominant-baseline: middle;
        text-anchor: middle;
      }
    </style>
  </head>
  <body>
    <script>
      var svg = d3
        .select("body")
        .append("svg")
        .attr("width", 900)
        .attr("height", 600)
        .append("g")
        .attr("transform", "translate(50,50)");

      // Data, as parsed from csv (change later)
      // Add ids
      var data = [
        { child: "John", parent: "" },
        { child: "Aaron", parent: "Kevin" },
        { child: "Kevin", parent: "John" },
        { child: "Hannah", parent: "Ann" },
        { child: "Rose", parent: "Sarah" },
        { child: "Ann", parent: "John" },
        { child: "Sarah", parent: "Kevin" },
        { child: "Mark", parent: "Ann" },
        { child: "Angel", parent: "Sarah" },
        { child: "Tom", parent: "Hannah" },
        { child: "Bill", parent: "Sarah" }
      ];

      var dataStructure = d3.stratify()
                            .id(function(d){return d.child;})
                            .parentId(function(d){return d.parent;})
                            (data);

      var treeStructure = d3.tree().size([650,300]);
      var information = treeStructure(dataStructure);
      console.log(information.descendants());
      console.log(information.links());

      // Elbow Connectors
      var connections = svg.append("g").selectAll("path").data(information.links());
      connections.enter().append("path")
                          .attr("d", function (d) {
                            return "M" + d.source.x + "," + d.source.y + " v 50 H" +
                            d.target.x + " V" + d.target.y;
                          });

      // Rectangles will become Person cards (Name, age, picture, etc.)
      var rectangles = svg.append("g").selectAll("rect").data(information.descendants());
      rectangles.enter().append("rect")
        .attr("x", function(d){return d.x - 40})
        .attr("y", function(d){return d.y - 20});

      var names = svg.append("g").selectAll("text")
                                .data(information.descendants());
      names.enter().append("text")
                   .text(function(d){return d.data.child;})
                   .attr("x", function(d){return d.x;})
                   .attr("y", function(d){return d.y;})
    </script>
  </body>
</html>
